<!DOCTYPE html>
<html>
<head>
	
	<title>Quick Start - Leaflet</title>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	
	<link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />

    <link rel="stylesheet" href="leaflet/leaflet.css" />
    <script src="leaflet/leaflet-src.js" ></script>
	<script src="js/jquery-3.2.1.min.js"></script>
	<script src="js/manageModal.js"></script>
	<script src="js/main.js"></script>
	<link rel="stylesheet" href="js/bootstrap/css/bootstrap.css" >

	
</head>
<body>
<div id="mapid" style="width: 100%; height: 100%; position:fixed;"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="js/bootstrap/js/bootstrap.min.js"></script>
<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
	Launch demo modal
</button>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">Datos Planta</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<form action="#" method="POST" role="form" name="form" id="register" >
					<div class="form-group">
						<label for="plantHeight" class="col-form-label">Altura:</label>
						<input type="text" class="form-control" id="plantHeight" name="altura">
					</div>
					<div class="form-group">
						<label for="numBranches" class="col-form-label">NÃºmero de Ramas:</label>
						<input class="form-control" id="numBranches" name="numRamas"/>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
						<button type="submit" class="btn btn-primary" data-name="register" onclick="formSubmit(event)">Guardar</button>
					</div>
				</form>
			</div>

		</div>
	</div>
</div>
<script>
	var jwtToken = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoyLCJlbWFpbCI6IiIsInVzZXJuYW1lIjoiSnVsaWFuIiwiZXhwIjoxNjI4NTUwODQ4fQ.mCYKGBbjINR05wod4fycAK5lSTY88sMuC58JQpOiBvI";
	var mymap = L.map('mapid').setView(new L.LatLng(2.3951228022907083, -76.7386613044317), 21);
	window.leafletmap = mymap;
	var southWest = L.latLng([2.394703853406243, -76.73893726213578]),
	northEast = L.latLng([2.3955428881953593, -76.73763781096866]),
	bounds = L.latLngBounds([southWest, northEast]);
	var googleTraffic = L.tileLayer('http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
        maxZoom: 25,
        minZoom: 0,
        subdomains: ['mt0', 'mt1', 'mt2', 'mt3'],
    }).addTo(mymap);
    $.ajax({
            url: "http://"+location.hostname + ":8000/api/token-auth/",
            cache: false,
            type: "POST",
            contentType: "application/json",
            data: '{"username": "Julian","password": "940925jabort"}',
    		dataType: 'json',
            success: function (json) {
                console.log(json);
				L.tileLayer("http://"+ location.hostname+':8000/api/projects/2/tasks/121acf05-fe78-4587-ade9-42b467bfa233/orthophoto/tiles/{z}/{x}/{y}.png?jwt='+json.token, {
					bounds:bounds,
					minZoom: 0,
					maxZoom: 124,
					maxNativeZoom: 24,
					tms:false,
					detectRetina: true
				}).addTo(mymap);
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                console.log("Status: " + textStatus);
                console.log("Error: " + errorThrown);
            }
        });
</script>
</body>
</html>
